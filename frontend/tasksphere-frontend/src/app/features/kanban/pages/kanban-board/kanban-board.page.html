<div class="kanban-page">
  <header-component
    title="Kanban de Projetos"
    subtitle="Clique no card para ver o Kanban de tasks do projeto"
  ></header-component>

  <div *ngIf="loading">Carregando...</div>
  <div *ngIf="!loading && errorMessage" class="error">{{ errorMessage }}</div>

  <div class="kanban-columns" *ngIf="!loading && !errorMessage">
    <div class="kanban-column" *ngFor="let status of columnsOrder">
      <h3 class="column-title" [style.color]="getLabelForStatus(status).color">
        {{ getLabelForStatus(status).label }}
      </h3>
      <div class="column-list">
        <div
          class="project-card"
          *ngFor="let p of columns[status]"
        >
          <list-card-component
            [title]="p.name"
            [description]="p.description"
            [color]="getLabelForStatus(status).color"
            (onClick)="openProject(p)"
          >
            <small>
              <img
                class="avatar"
                [src]="p.owner?.profilePictureUrl || avatarDefaultPath"
                [alt]="p.owner?.name"
              />
              {{ p.owner?.name || 'â€”' }}
            </small>
            <small>{{ p.tasks?.length || 0 }} tasks</small>
          </list-card-component>
        </div>
        <div *ngIf="columns[status]?.length === 0" class="empty">Nenhum projeto</div>
      </div>
    </div>
  </div>
</div>
